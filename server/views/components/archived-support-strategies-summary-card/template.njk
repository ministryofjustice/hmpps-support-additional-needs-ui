{% from "govuk/macros/attributes.njk" import govukAttributes %}
{% from "govuk/components/details/macro.njk" import govukDetails %}

{#- Set classes for this component #}
{%- set classNames = "govuk-summary-card" -%}
{%- if params.classes %}
  {% set classNames = classNames + " " + params.classes %}
{% endif %}

{#- Define component attributes #}
{%- set componentAttributes %} class="{{ classNames }}" {{- govukAttributes(params.attributes) -}} {% if params.id %} id="{{ params.id }}"{% endif %}{% endset %}

{% set archivedSupportStrategies = params.archivedSupportStrategies %}

{% if archivedSupportStrategies | length %}
  <div {{ componentAttributes | safe }}>
    <div class="govuk-summary-card__title-wrapper">
      <h2 class="govuk-summary-card__title">{{ params.title }}</h2>
    </div>

    <div class="govuk-summary-card__content govuk-!-padding-top-0">
      <div class="govuk-summary-list">

        {% for supportStrategy in archivedSupportStrategies %}
          <div class="govuk-summary-list__row support-strategy">
            <p class="govuk-body govuk-!-margin-top-3 app-u-multiline-text" data-qa="support-strategy-details">{{ supportStrategy.supportStrategyDetails }}</p>

            <h3 class="govuk-heading-s govuk-!-margin-bottom-1">Reason for moving to the History</h3>
            <p class="govuk-body app-u-multiline-text" data-qa="archived-support-strategy-reason">{{ supportStrategy.archiveReason }}</p>

            <p class="govuk-hint govuk-body govuk-!-font-size-16" data-qa="support-strategy-audit">
              {% set prisonName = params.prisonNamesById[supportStrategy.updatedAtPrison] | default(supportStrategy.updatedAtPrison) %}
              Moved to history on {{ supportStrategy.updatedAt | formatDate('d MMM yyyy') }}<span class="govuk-!-display-none-print"> by {{ supportStrategy.updatedByDisplayName }}, {{ prisonName }}</span>
            </p>
          </div>
        {% endfor %}

      </div>
    </div>
  </div>
{% endif %}
